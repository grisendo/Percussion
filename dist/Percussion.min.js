/*! Percussion v0.1.0 | (c) 2015 grisendo */
!function(){var a=function(a){"undefined"==typeof a&&(a={}),this.lineSize=20,this.pointSize=10,this.speed=20,this.timeout=250,this.autoScroll=!0,this.colors=[],this.textColors=[],this.eventIn=null,this.eventOut=null,this.position=document.body,this.print=!1,this._setOptions(a),this.interval=null,this.canvas=null,this.canvasIn=null,this.running=!1,this.lines=0,this.time=0,this.counter=0,this.streams=[],this.events=[],this._startCanvas()};a.prototype._setOptions=function(a){"undefined"!=typeof a.lineSize?this.lineSize=a.lineSize:null,"undefined"!=typeof a.pointSize?this.pointSize=a.pointSize:null,"undefined"!=typeof a.speed?this.speed=a.speed:null,"undefined"!=typeof a.timeout?this.timeout=a.timeout:null,"undefined"!=typeof a.autoScroll?this.autoScroll=a.autoScroll:null,"undefined"!=typeof a.colors?this.colors=a.colors:null,"undefined"!=typeof a.textColors?this.textColors=a.textColors:null,"undefined"!=typeof a.eventIn?this.eventIn=a.eventIn:null,"undefined"!=typeof a.eventOut?this.eventOut=a.eventOut:null,"undefined"!=typeof a.position?this.position=a.position:null,"undefined"!=typeof a.print?this.print=a.print:null},a.prototype._startCanvas=function(){this.lines=0,this.time=0,this.counter=0,this.running=!1,this.colors&&0!=this.colors.length||(this.colors=["#FF0000","#00FF00","#0000FF"]),this.textColors&&0!=this.textColors.length||(this.textColors=["#FFFFFF","#FFFFFF","#FFFFFF"]),this.eventIn||("undefined"!=typeof Bacon||"undefined"!=typeof Kefir?this.eventIn="onValue":"undefined"!=typeof Rx&&(this.eventIn="subscribe")),this.eventOut||("undefined"!=typeof Bacon?this.eventOut="":"undefined"!=typeof Rx?this.eventOut="dispose":"undefined"!=typeof Kefir&&(this.eventOut="_clear")),this.canvas=document.createElement("DIV"),this.canvasIn=document.createElement("DIV"),this.canvas.style.position="relative",this.canvas.style.width="100%",this.canvas.style.overflowX="auto",this.canvas.style.overflowY="hidden",this.canvasIn.style.position="relative",this.canvasIn.style.width=0,this.canvas.appendChild(this.canvasIn),this.position.appendChild(this.canvas),this.start();for(var a in this.streams)this.addStream(this.streams[a],!0)},a.prototype.addStream=function(a,b){"undefined"==typeof b&&(b=!1),b||this.streams.push(a);var c=this.lines,d=document.createElement("DIV"),e=this.colors[this.counter],f=this.textColors[this.counter];if(d.style.position="absolute",d.style.width="100%",d.style.top=this.lines*this.lineSize+this.pointSize+"px",d.style.left=0,d.style.height="1px",d.style.background="#000",this.canvasIn.appendChild(d),this.eventIn&&"function"==typeof a[this.eventIn]){var g=this,h=a[this.eventIn](function(a){if(g.running){var b=document.createElement("DIV");b.style.borderRadius="50%",b.style.minWidth=g.pointSize+"px",b.style.minHeight=g.pointSize+"px",b.style.position="absolute",b.style.top=c*g.lineSize+g.pointSize/2+"px",b.style.background=e,b.style.cursor="pointer",b.style.left=g.time+"px",b.style.color=f,"object"!=typeof a?(b.title=a,g.print&&(b.innerHTML=a)):b.title="Object: Click to view value via Javascript Console",b.onclick=function(){console.log(a)},g.canvasIn.appendChild(b)}});this.events.push(h)}this.counter++,this.counter=this.counter%3,this.lines++,this.canvas.style.height=(this.lines+1)*this.lineSize+"px",this.canvasIn.style.height=this.canvas.style.height},a.prototype.stop=function(){this.running&&(this.running=!1,this.interval&&clearInterval(this.interval))},a.prototype.start=function(){if(!this.running){this.running=!0;var a=this;this.interval=setInterval(function(){a.running&&(a.time+=a.speed,a.canvasIn.style.width=a.time+"px",a.autoScroll&&(a.canvas.scrollLeft=a.time))},this.timeout)}},a.prototype.setAutoScroll=function(a){this.autoScroll=a},a.prototype.restart=function(){this.stop(),this.canvas.parentNode.removeChild(this.canvas);for(var a in this.events)""===this.eventOut?this.events[a]():eventOut&&this.events[a][this.eventOut]();this.events=[],this._startCanvas()},window.Percussion=a}();
